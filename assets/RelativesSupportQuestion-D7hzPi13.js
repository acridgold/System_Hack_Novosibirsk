import{r as o,j as t,P,B as c,L as T,T as k}from"./index-Cp6pflDg.js";const B=({question:$,currentAnswer:y,onAnswer:p})=>{var D,M,R,C;const[I,j]=o.useState(y!==void 0?y:1),[s,L]=o.useState(!1),[f,E]=o.useState(null),l=o.useRef(null),a=o.useRef([{id:1,x:0,y:0,baseX:0},{id:2,x:0,y:0,baseX:0}]),n=350,b=300,w=["/questionsAssets/RelativesSupportQuestion/womanLeft.png","/questionsAssets/RelativesSupportQuestion/womanRight.png"];o.useEffect(()=>{if(!l.current)return;const i=l.current.offsetWidth/2-150,r=50;a.current=[{id:1,x:i-n/2-r,y:0,baseX:i-n/2-r,isLeft:!0},{id:2,x:i+r,y:0,baseX:i+r,isLeft:!1}],j(1),p(1)},[]);const x=o.useCallback((e,i)=>{L(!0);const r=a.current.find(g=>g.id===e);E(r.isLeft?"left":"right"),i.preventDefault()},[]),u=o.useCallback(e=>{if(!s||!l.current)return;const i=l.current.getBoundingClientRect(),r=e.clientX||e.touches&&e.touches[0].clientX;if(!r)return;const g=r-i.left,m=i.width/2;let h;f==="left"?h=Math.max(0,Math.min(b/2,m-g-n/2)):h=Math.max(0,Math.min(b/2,g-m-n/2));const W=h/(b/2),F=Math.max(0,Math.min(1,1-W)),S=a.current.find(v=>v.isLeft),X=a.current.find(v=>!v.isLeft);S&&X&&(S.x=m-n/2-h,X.x=m-n/2+h),j(F),p(F)},[s,f,p,n]),d=o.useCallback(()=>{L(!1),E(null)},[]);return o.useEffect(()=>(s&&(document.addEventListener("mousemove",u),document.addEventListener("mouseup",d),document.addEventListener("touchmove",u),document.addEventListener("touchend",d)),()=>{document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",d),document.removeEventListener("touchmove",u),document.removeEventListener("touchend",d)}),[s,u,d]),t.jsx(P,{elevation:3,sx:{p:4,border:"2px solid #E0EFE5",background:"#FFFFFF",position:"relative",overflow:"hidden",minHeight:"500px",display:"flex",flexDirection:"column",width:"100%",height:"100%"},children:t.jsxs(c,{ref:l,sx:{display:"flex",flexDirection:"column",alignItems:"center",flex:1,width:"100%",height:"100%",position:"relative"},children:[t.jsx(c,{sx:{mb:3,textAlign:"center",width:"100%"},children:t.jsxs(c,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:1,mt:2},children:[t.jsx(T,{variant:"determinate",value:I*100,sx:{width:"100%",height:10,borderRadius:5,backgroundColor:"#f0f0f0","& .MuiLinearProgress-bar":{backgroundColor:"#4CAF50",borderRadius:5}}}),t.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",width:"100%",mt:.5},children:[t.jsx(k,{variant:"body2",color:"#000000",fontWeight:"bold",children:"Я не чувствую поддержку"}),t.jsx(k,{variant:"body2",color:"#000000",fontWeight:"bold",children:"Меня поддерживают близкие"})]})]})}),t.jsxs(c,{sx:{position:"relative",width:"100%",height:"300px",display:"flex",justifyContent:"center",alignItems:"center",mb:2},children:[t.jsx(c,{sx:{position:"absolute",left:((D=a.current[0])==null?void 0:D.x)||0,top:((M=a.current[0])==null?void 0:M.y)||0,width:`${n}px`,height:`${n}px`,cursor:s?"grabbing":"grab",transition:s?"none":"all 0.3s ease",zIndex:f==="left"?10:1,display:"flex",alignItems:"center",justifyContent:"center","&:hover":{transform:s?"none":"scale(1.05)"}},onMouseDown:e=>x(1,e),onTouchStart:e=>x(1,e),children:t.jsx("img",{src:w[0],alt:"Объект 1",style:{width:"100%",height:"100%",objectFit:"contain",display:"block"},onError:e=>{e.target.style.display="none"}})}),t.jsx(c,{sx:{position:"absolute",left:((R=a.current[1])==null?void 0:R.x)||0,top:((C=a.current[1])==null?void 0:C.y)||0,width:`${n}px`,height:`${n}px`,cursor:s?"grabbing":"grab",transition:s?"none":"all 0.3s ease",zIndex:f==="right"?10:1,display:"flex",alignItems:"center",justifyContent:"center","&:hover":{transform:s?"none":"scale(1.05)"}},onMouseDown:e=>x(2,e),onTouchStart:e=>x(2,e),children:t.jsx("img",{src:w[1],alt:"Объект 2",style:{width:"100%",height:"100%",objectFit:"contain",display:"block"},onError:e=>{e.target.style.display="none"}})})]})]})})};export{B as default};
