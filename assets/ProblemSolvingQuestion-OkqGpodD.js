import{r as i,j as l,P as H,B as u,T as R}from"./index-CIxEWNSq.js";const U=({question:V,currentAnswer:X,onAnswer:Y})=>{const[k,z]=i.useState(X!==void 0?X:1),[f,C]=i.useState([]),[h,I]=i.useState(null),b=i.useRef(null),[n,F]=i.useState({width:500,height:400}),w=6,x=70,o=350,$=Array.from({length:w},(t,e)=>`/questionsAssets/ProblemSolvingQuestion/${(e+1).toString().padStart(4,"0")}.png`),D=i.useCallback((t,e)=>{const r=[],d=2*Math.PI/w;for(let a=0;a<w;a++){const s=a*d,c=(Math.random()-.5)*.3,g=s+c,m=x*(.9+Math.random()*.2);r.push({angle:g,distance:m,targetX:t+Math.cos(g)*m,targetY:e+Math.sin(g)*m,rotation:(Math.random()-.5)*60,scale:.7+Math.random()*.2})}return r},[x,w]);i.useEffect(()=>{const t=()=>{if(b.current){const{width:e,height:r}=b.current.getBoundingClientRect();F({width:e,height:r})}};return t(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},[]),i.useEffect(()=>{if(n.width===0||n.height===0)return;const t=n.width/2,e=n.height/2,r=D(t,e),d=Array.from({length:w},(a,s)=>{const c=r[s];return{id:s,x:t,y:e,targetX:c.targetX,targetY:c.targetY,maxRotation:c.rotation,maxScale:c.scale,rotation:0,scale:1,path:$[s]}});C(d)},[n,D]),i.useEffect(()=>{if(f.length===0)return;const t=n.width/2,e=n.height/2;let r=0;f.forEach(s=>{const c=Math.sqrt(Math.pow(s.x-t,2)+Math.pow(s.y-e,2));r+=c});const d=r/f.length,a=Math.max(0,Math.min(1,1-d/x));z(a),Y(a)},[f,Y,n,x]);const L=i.useCallback((t,e)=>{I(t),e.preventDefault()},[]),v=i.useCallback(t=>{if(h===null||!b.current)return;const e=b.current.getBoundingClientRect(),r=t.clientX||t.touches&&t.touches[0].clientX,d=t.clientY||t.touches&&t.touches[0].clientY;if(!r||!d)return;const a=n.width/2,s=n.height/2;let c=r-e.left,g=d-e.top;c=Math.max(o/2,Math.min(n.width-o/2,c)),g=Math.max(o/2,Math.min(n.height-o/2,g));const m=Math.sqrt(Math.pow(c-a,2)+Math.pow(g-s,2)),E=15;let p=0;m>E&&(p=Math.min(1,(m-E)/(x-E))),C(P=>P.map(y=>{let j,S;p===0?(j=a,S=s):(j=a+(y.targetX-a)*p,S=s+(y.targetY-s)*p);const A=p*y.maxRotation,q=1-p*(1-y.maxScale),B=Math.max(o/2,Math.min(n.width-o/2,j)),T=Math.max(o/2,Math.min(n.height-o/2,S));return{...y,x:B,y:T,rotation:A,scale:q}}))},[h,n,x,o]),M=i.useCallback(()=>{I(null)},[]);return i.useEffect(()=>(h!==null&&(document.addEventListener("mousemove",v),document.addEventListener("mouseup",M),document.addEventListener("touchmove",v),document.addEventListener("touchend",M)),()=>{document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",M),document.removeEventListener("touchmove",v),document.removeEventListener("touchend",M)}),[h,v,M]),l.jsx(H,{elevation:3,sx:{p:4,border:"2px solid #E0EFE5",background:"#FFFFFF",position:"relative",overflow:"hidden",minHeight:"600px",display:"flex",flexDirection:"column",width:"100%",height:"100%"},children:l.jsx(u,{sx:{display:"flex",flexDirection:"column",alignItems:"center",flex:1,width:"100%",height:"100%"},children:l.jsxs(u,{sx:{display:"flex",width:"100%",height:"100%",flex:1,gap:3,alignItems:"stretch"},children:[l.jsxs(u,{sx:{display:"flex",flexDirection:"column",alignItems:"center",width:100,height:"100%",minHeight:"500px",borderRadius:2},children:[l.jsx(R,{variant:"body1",color:"text.primary",sx:{fontWeight:"bold",mb:2,textAlign:"center",fontSize:"14px"},children:"Я быстро сдаюсь"}),l.jsx(u,{sx:{position:"relative",width:25,height:"500px",backgroundColor:"#e9ecef",borderRadius:20,overflow:"hidden",flex:1,border:"2px solid #adb5bd"},children:l.jsx(u,{sx:{position:"absolute",bottom:0,left:0,width:"100%",height:`${100-k*100}%`,backgroundColor:"#4CAF50",borderRadius:"20px 20px 0 0",transition:"height 0.3s ease"}})}),l.jsx(R,{variant:"body1",color:"text.primary",sx:{fontWeight:"bold",mt:2,textAlign:"center",fontSize:"14px"},children:"Я иду до конца"})]}),l.jsx(u,{ref:b,sx:{position:"relative",width:"100%",height:"100%",minHeight:"500px",overflow:"hidden",cursor:h!==null?"grabbing":"default",flex:1},children:f.map(t=>l.jsx(u,{sx:{position:"absolute",left:t.x-o/2,top:t.y-o/2,width:`${o}px`,height:`${o}px`,cursor:h!==null?"grabbing":"grab",transform:`rotate(${t.rotation}deg) scale(${t.scale})`,transition:h!==null?"all 0.1s ease":"all 0.5s ease",zIndex:h===t.id?10:1},onMouseDown:e=>L(t.id,e),onTouchStart:e=>L(t.id,e),children:l.jsx(u,{sx:{width:"100%",height:"100%",borderRadius:"8px",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",background:"transparent"},children:l.jsx("img",{src:t.path,alt:`Объект ${t.id+1}`,style:{width:"100%",height:"100%",objectFit:"contain",display:"block"},onError:e=>{e.target.style.display="none"}})})},t.id))})]})})})};export{U as default};
